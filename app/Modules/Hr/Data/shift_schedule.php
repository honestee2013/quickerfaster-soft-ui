<?php

return [
  'model' => 'App\Modules\Hr\Models\ShiftSchedule',
  'fieldDefinitions' => [
    'employee_id' => [
      'display' => 'inline',
      'field_type' => 'select',
      'label' => 'Employee',
      'validation' => 'required|exists:employees,id',
      'relationship' => [
        'model' => 'App\Modules\Hr\Models\Employee',
        'type' => 'belongsTo',
        'display_field' => 'employee_number',
        'dynamic_property' => 'employee',
        'foreign_key' => 'employee_id',
        'inlineAdd' => false,
      ],
      'options' => [
        'model' => 'App\Modules\Hr\Models\Employee',
        'column' => 'employee_number',
        'hintField' => 'first_name,last_name',
      ],
    ],
    'shift_id' => [
      'display' => 'inline',
      'field_type' => 'select',
      'label' => 'Shift',
      'validation' => 'required|exists:shifts,id',
      'relationship' => [
        'model' => 'App\Modules\Hr\Models\Shift',
        'type' => 'belongsTo',
        'display_field' => 'name',
        'dynamic_property' => 'shift',
        'foreign_key' => 'shift_id',
        'inlineAdd' => false,
      ],
      'options' => [
        'model' => 'App\Modules\Hr\Models\Shift',
        'column' => 'name',
        'hintField' => 'start_time,end_time',
      ],
    ],
    'schedule_date' => [
      'display' => 'inline',
      'field_type' => 'datepicker',
      'label' => 'Schedule Date',
      'validation' => 'required|date',
    ],
    'status' => [
      'display' => 'inline',
      'field_type' => 'select',
      'label' => 'Status',
      'validation' => 'required',
      'options' => [
        'scheduled' => 'Scheduled',
        'confirmed' => 'Confirmed',
        'cancelled' => 'Cancelled',
        'swapped' => 'Swapped',
        'completed' => 'Completed',
        'no_show' => 'No Show',
      ],
    ],
    'start_time_override' => [
      'display' => 'inline',
      'field_type' => 'timepicker',
      'label' => 'Custom Start Time',
      'validation' => 'nullable',
    ],
    'end_time_override' => [
      'display' => 'inline',
      'field_type' => 'timepicker',
      'label' => 'Custom End Time',
      'validation' => 'nullable|after:start_time_override',
    ],
    'actual_start_time' => [
      'display' => 'inline',
      'field_type' => 'datetimepicker',
      'label' => 'Actual Start',
      'maxSizeMB' => 1,
    ],
    'actual_end_time' => [
      'display' => 'inline',
      'field_type' => 'datetimepicker',
      'label' => 'Actual End',
      'maxSizeMB' => 1,
    ],
    'notes' => [
      'display' => 'inline',
      'field_type' => 'textarea',
      'label' => 'Notes',
      'validation' => 'nullable|string|max:1000',
    ],
    'approved_by' => [
      'display' => 'inline',
      'field_type' => 'string',
      'label' => 'Approved By',
      'maxSizeMB' => 1,
    ],
    'approved_at' => [
      'display' => 'inline',
      'field_type' => 'datetimepicker',
      'label' => 'Approved At',
      'maxSizeMB' => 1,
    ],
    'is_cover_required' => [
      'display' => 'inline',
      'field_type' => 'boolcheckbox',
      'label' => 'Cover Required',
      'validation' => 'boolean',
    ],
    'cover_employee_id' => [
      'display' => 'inline',
      'field_type' => 'select',
      'label' => 'Cover Employee',
      'validation' => 'nullable|exists:employees,id',
      'relationship' => [
        'model' => 'App\Modules\Hr\Models\Employee',
        'type' => 'belongsTo',
        'display_field' => 'employee_number',
        'dynamic_property' => 'coverEmployee',
        'foreign_key' => 'cover_employee_id',
        'inlineAdd' => false,
      ],
      'options' => [
        'model' => 'App\Modules\Hr\Models\Employee',
        'column' => 'employee_number',
        'hintField' => 'first_name,last_name',
      ],
    ],
    'attendance_id' => [
      'display' => 'inline',
      'field_type' => 'select',
      'label' => 'Attendance Record',
      'validation' => 'nullable|exists:attendances,id',
      'relationship' => [
        'model' => 'App\Modules\Hr\Models\Attendance',
        'type' => 'belongsTo',
        'display_field' => 'date',
        'dynamic_property' => 'attendance',
        'foreign_key' => 'attendance_id',
        'inlineAdd' => false,
      ],
      'options' => [
        'model' => 'App\Modules\Hr\Models\Attendance',
        'column' => 'date',
        'hintField' => '',
      ],
    ],
    'schedule_type' => [
      'display' => 'inline',
      'field_type' => 'select',
      'label' => 'Schedule Type',
      'validation' => 'nullable',
      'options' => [
        'regular' => 'Regular Schedule',
        'overtime' => 'Overtime',
        'on_call' => 'On-Call',
        'training' => 'Training',
        'meeting' => 'Meeting',
        'project' => 'Project Work',
      ],
    ],
    'is_published' => [
      'display' => 'inline',
      'field_type' => 'boolcheckbox',
      'label' => 'Published',
      'validation' => 'boolean',
    ],
    'published_at' => [
      'display' => 'inline',
      'field_type' => 'datetimepicker',
      'label' => 'Published At',
      'maxSizeMB' => 1,
    ],
    'created_from_template' => [
      'display' => 'inline',
      'field_type' => 'boolcheckbox',
      'label' => 'Created from Template',
      'maxSizeMB' => 1,
    ],
    'last_modified_by' => [
      'display' => 'inline',
      'field_type' => 'string',
      'label' => 'Last Modified By',
      'maxSizeMB' => 1,
    ],
    'last_modified_at' => [
      'display' => 'inline',
      'field_type' => 'datetimepicker',
      'label' => 'Last Modified At',
      'maxSizeMB' => 1,
    ],
  ],
  'hiddenFields' => [
    'onTable' => [
      '0' => 'actual_start_time',
      '1' => 'actual_end_time',
      '2' => 'approved_by',
      '3' => 'approved_at',
      '4' => 'attendance_id',
      '5' => 'published_at',
      '6' => 'created_from_template',
      '7' => 'last_modified_by',
      '8' => 'last_modified_at',
    ],
    'onNewForm' => [
      '0' => 'actual_start_time',
      '1' => 'actual_end_time',
      '2' => 'approved_by',
      '3' => 'approved_at',
      '4' => 'attendance_id',
      '5' => 'published_at',
      '6' => 'created_from_template',
      '7' => 'last_modified_by',
      '8' => 'last_modified_at',
    ],
    'onEditForm' => [
      '0' => 'actual_start_time',
      '1' => 'actual_end_time',
      '2' => 'approved_by',
      '3' => 'approved_at',
      '4' => 'attendance_id',
      '5' => 'created_from_template',
      '6' => 'last_modified_by',
      '7' => 'last_modified_at',
    ],
    'onQuery' => [],
  ],
  'simpleActions' => [
    '0' => 'show',
    '1' => 'edit',
    '2' => 'delete',
  ],
  'isTransaction' => false,
  'dispatchEvents' => false,
  'controls' => [
    'addButton' => [
      '0' => [
        'label' => 'New Schedule',
        'type' => 'quick_add',
        'icon' => 'fas fa-plus-circle',
        'primary' => true,
      ],
      '1' => [
        'label' => 'Bulk Schedule',
        'type' => 'modal',
        'icon' => 'fas fa-users',
        'url' => '/hr/shift-schedules/bulk-create',
        'modalSize' => 'xl',
      ],
      '2' => [
        'label' => 'Copy Week',
        'type' => 'dropdown',
        'icon' => 'fas fa-copy',
        'items' => [
          '0' => [
            'label' => 'Copy Previous Week',
            'icon' => 'fas fa-arrow-left',
            'route' => 'shift-schedules.copy-week',
            'params' => [
              'direction' => 'previous',
            ],
          ],
          '1' => [
            'label' => 'Copy to Next Week',
            'icon' => 'fas fa-arrow-right',
            'route' => 'shift-schedules.copy-week',
            'params' => [
              'direction' => 'next',
            ],
          ],
        ],
      ],
    ],
    'files' => [
      'export' => [
        '0' => 'xls',
        '1' => 'csv',
        '2' => 'pdf',
      ],
      'print' => true,
    ],
    'bulkActions' => [
      'export' => [
        '0' => 'xls',
        '1' => 'csv',
        '2' => 'pdf',
      ],
      'publish' => [
        'label' => 'Publish Selected',
        'icon' => 'fas fa-eye',
        'updateModelField' => 'is_published',
        'fieldValue' => true,
        'actionName' => 'bulk_publish_schedules',
      ],
      'unpublish' => [
        'label' => 'Unpublish Selected',
        'icon' => 'fas fa-eye-slash',
        'updateModelField' => 'is_published',
        'fieldValue' => false,
        'actionName' => 'bulk_unpublish_schedules',
      ],
      'confirm' => [
        'label' => 'Confirm Selected',
        'icon' => 'fas fa-check-circle',
        'updateModelField' => 'status',
        'fieldValue' => 'confirmed',
        'actionName' => 'bulk_confirm_schedules',
      ],
      'cancel' => [
        'label' => 'Cancel Selected',
        'icon' => 'fas fa-ban',
        'updateModelField' => 'status',
        'fieldValue' => 'cancelled',
        'actionName' => 'bulk_cancel_schedules',
        'confirm' => 'Cancel selected schedules?',
      ],
    ],
    'perPage' => [
      '0' => 10,
      '1' => 25,
      '2' => 50,
      '3' => 100,
    ],
    'search' => true,
    'showHideColumns' => true,
    'filters' => [
      '0' => [
        'field' => 'employee_id',
        'type' => 'select',
        'optionsFrom' => 'employees',
        'label' => 'Employee',
      ],
      '1' => [
        'field' => 'shift_id',
        'type' => 'select',
        'optionsFrom' => 'shifts',
        'label' => 'Shift',
      ],
      '2' => [
        'field' => 'status',
        'type' => 'select',
        'options' => [
          '0' => 'All',
          '1' => 'Scheduled',
          '2' => 'Confirmed',
          '3' => 'Cancelled',
          '4' => 'Swapped',
          '5' => 'Completed',
          '6' => 'No Show',
        ],
        'label' => 'Status',
      ],
      '3' => [
        'field' => 'schedule_date',
        'type' => 'date_range',
        'label' => 'Date Range',
      ],
      '4' => [
        'field' => 'is_published',
        'type' => 'select',
        'options' => [
          '0' => 'All',
          '1' => 'Published',
          '2' => 'Unpublished',
        ],
        'label' => 'Published Status',
      ],
      '5' => [
        'field' => 'schedule_type',
        'type' => 'select',
        'options' => [
          '0' => 'All',
          '1' => 'Regular',
          '2' => 'Overtime',
          '3' => 'On-Call',
          '4' => 'Training',
          '5' => 'Meeting',
          '6' => 'Project',
        ],
        'label' => 'Schedule Type',
      ],
      '6' => [
        'field' => 'is_cover_required',
        'type' => 'select',
        'options' => [
          '0' => 'All',
          '1' => 'Needs Cover',
          '2' => 'Covered',
        ],
        'label' => 'Cover Status',
      ],
    ],
    'calendarView' => [
      'enable' => true,
      'defaultView' => 'week',
      'views' => [
        '0' => 'day',
        '1' => 'week',
        '2' => 'month',
      ],
      'resourceField' => 'employee_id',
      'startField' => 'schedule_date',
      'endField' => 'schedule_date',
      'titleField' => 'shift.name',
      'colorField' => 'shift.color',
      'statusField' => 'status',
    ],
  ],
  'fieldGroups' => [
    'assignment' => [
      'title' => 'Employee & Shift Assignment',
      'groupType' => 'hr',
      'icon' => 'fas fa-user-clock',
      'fields' => [
        '0' => 'employee_id',
        '1' => 'shift_id',
        '2' => 'schedule_date',
        '3' => 'status',
        '4' => 'schedule_type',
      ],
    ],
    'timing_overrides' => [
      'title' => 'Timing Overrides',
      'groupType' => 'hr',
      'icon' => 'fas fa-edit',
      'fields' => [
        '0' => 'start_time_override',
        '1' => 'end_time_override',
      ],
    ],
    'coverage' => [
      'title' => 'Coverage & Status',
      'groupType' => 'hr',
      'icon' => 'fas fa-users',
      'fields' => [
        '0' => 'is_cover_required',
        '1' => 'cover_employee_id',
        '2' => 'is_published',
        '3' => 'notes',
      ],
    ],
    'system_info' => [
      'title' => 'System Information',
      'groupType' => 'hr',
      'icon' => 'fas fa-server',
      'fields' => [
        '0' => 'actual_start_time',
        '1' => 'actual_end_time',
        '2' => 'attendance_id',
        '3' => 'approved_by',
        '4' => 'approved_at',
        '5' => 'published_at',
        '6' => 'created_from_template',
        '7' => 'last_modified_by',
        '8' => 'last_modified_at',
      ],
    ],
  ],
  'moreActions' => [
    '0' => [
      'title' => 'Confirm Schedule',
      'icon' => 'fas fa-check-circle',
      'updateModelField' => true,
      'fieldName' => 'status',
      'fieldValue' => 'confirmed',
      'actionName' => 'confirm_schedule',
      'confirm' => 'Confirm this schedule?',
      'condition' => [
        '0' => [
          'status' => 'scheduled',
        ],
      ],
    ],
    '1' => [
      'title' => 'Cancel Schedule',
      'icon' => 'fas fa-ban',
      'updateModelField' => true,
      'fieldName' => 'status',
      'fieldValue' => 'cancelled',
      'actionName' => 'cancel_schedule',
      'confirm' => 'Cancel this schedule?',
      'condition' => [
        '0' => [
          'status' => [
            '0' => 'scheduled',
            '1' => 'confirmed',
          ],
        ],
      ],
    ],
    '2' => [
      'title' => 'Mark as Completed',
      'icon' => 'fas fa-flag-checkered',
      'updateModelField' => true,
      'fieldName' => 'status',
      'fieldValue' => 'completed',
      'actionName' => 'complete_schedule',
      'confirm' => 'Mark this schedule as completed?',
      'condition' => [
        '0' => [
          'status' => 'confirmed',
        ],
      ],
    ],
    '3' => [
      'title' => 'Publish to Employee',
      'icon' => 'fas fa-eye',
      'updateModelField' => true,
      'fieldName' => 'is_published',
      'fieldValue' => true,
      'actionName' => 'publish_schedule',
      'condition' => [
        '0' => [
          'is_published' => false,
        ],
      ],
    ],
    '4' => [
      'title' => 'Request Cover',
      'icon' => 'fas fa-user-plus',
      'updateModelField' => true,
      'fieldName' => 'is_cover_required',
      'fieldValue' => true,
      'actionName' => 'request_cover',
      'condition' => [
        '0' => [
          'is_cover_required' => false,
        ],
      ],
    ],
    '5' => [
      'title' => 'Swap Shift',
      'icon' => 'fas fa-exchange-alt',
      'route' => 'shift-swaps.create',
      'params' => [
        'schedule_id' => '{id}',
      ],
      'condition' => [
        '0' => [
          'status' => [
            '0' => 'scheduled',
            '1' => 'confirmed',
          ],
        ],
      ],
    ],
    '6' => [
      'title' => 'View Attendance',
      'icon' => 'fas fa-clock',
      'url' => 'attendances',
      'params' => [
        'id' => '{attendance_id}',
      ],
      'condition' => [
        '0' => [
          'attendance_id' => 'not null',
        ],
      ],
    ],
    '7' => [
      'title' => 'Copy to Another Date',
      'icon' => 'fas fa-copy',
      'route' => 'shift-schedules.copy',
      'params' => [
        'source_id' => '{id}',
      ],
    ],
    '8' => [
      'title' => 'Send Notification',
      'icon' => 'fas fa-bell',
      'route' => 'notifications.send',
      'params' => [
        'schedule_id' => '{id}',
        'type' => 'shift_reminder',
      ],
    ],
  ],
  'switchViews' => [
    'default' => 'list',
    'card' => [
      'titleFields' => [
        '0' => 'employee.first_name',
        '1' => 'employee.last_name',
      ],
      'subtitleFields' => [
        '0' => 'schedule_date',
        '1' => 'shift.name',
      ],
      'contentFields' => [
        '0' => 'status',
        '1' => 'schedule_type',
      ],
      'badgeField' => 'is_published',
      'badgeColors' => [
        'true' => 'success',
        'false' => 'warning',
      ],
    ],
    'list' => [
      'titleFields' => [
        '0' => 'employee.first_name',
        '1' => 'employee.last_name',
      ],
      'subtitleFields' => [
        '0' => 'schedule_date',
        '1' => 'shift.name',
      ],
      'contentFields' => [
        '0' => 'status',
        '1' => 'schedule_type',
        '2' => 'notes',
      ],
      'badgeField' => 'status',
      'badgeColors' => [
        'scheduled' => 'secondary',
        'confirmed' => 'success',
        'cancelled' => 'danger',
        'completed' => 'info',
        'swapped' => 'warning',
        'no_show' => 'dark',
      ],
    ],
    'detail' => [
      'layout' => 'tab',
      'detailType' => 'record',
      'titleFields' => [
        '0' => 'employee.first_name',
        '1' => 'employee.last_name',
      ],
      'subtitleFields' => [
        '0' => 'schedule_date',
        '1' => 'shift.name',
      ],
      'tabs' => [
        '0' => [
          'title' => 'Schedule Details',
          'icon' => 'fas fa-info-circle',
          'fields' => [
            '0' => 'employee_id',
            '1' => 'shift_id',
            '2' => 'schedule_date',
            '3' => 'status',
            '4' => 'schedule_type',
            '5' => 'is_published',
            '6' => 'notes',
          ],
        ],
        '1' => [
          'title' => 'Timing & Overrides',
          'icon' => 'fas fa-clock',
          'fields' => [
            '0' => 'start_time_override',
            '1' => 'end_time_override',
            '2' => 'actual_start_time',
            '3' => 'actual_end_time',
          ],
        ],
        '2' => [
          'title' => 'Coverage & Approval',
          'icon' => 'fas fa-users',
          'fields' => [
            '0' => 'is_cover_required',
            '1' => 'cover_employee_id',
            '2' => 'approved_by',
            '3' => 'approved_at',
          ],
        ],
        '3' => [
          'title' => 'Related Records',
          'icon' => 'fas fa-link',
          'fields' => [
            '0' => 'attendance_id',
          ],
          'relation' => 'attendance',
        ],
      ],
    ],
  ],
  'relations' => [
    'employee' => [
      'type' => 'belongsTo',
      'model' => 'App\Modules\Hr\Models\Employee',
      'foreignKey' => 'employee_id',
      'displayField' => 'employee_number',
      'hintField' => 'first_name,last_name',
    ],
    'shift' => [
      'type' => 'belongsTo',
      'model' => 'App\Modules\Hr\Models\Shift',
      'foreignKey' => 'shift_id',
      'displayField' => 'name',
      'hintField' => 'start_time,end_time',
    ],
    'coverEmployee' => [
      'type' => 'belongsTo',
      'model' => 'App\Modules\Hr\Models\Employee',
      'foreignKey' => 'cover_employee_id',
      'displayField' => 'employee_number',
      'hintField' => 'first_name,last_name',
    ],
    'attendance' => [
      'type' => 'belongsTo',
      'model' => 'App\Modules\Hr\Models\Attendance',
      'foreignKey' => 'attendance_id',
      'displayField' => 'date',
    ],
  ],
  'report' => [],
];
